<!-- note this script wont run on its own because we have set all paths relative to the main index file one level up where it is run from  -->

```{r setup, include=FALSE}
library(tidyverse)
library(ggpubr)

knitr::opts_chunk$set(echo = FALSE, message=FALSE, warning=FALSE, fig.align='center')
```

```{r input-data, include=FALSE}
# CANOPY 
ft_mean_ht <- readRDS('../../analysis/lidar-processing/data/lidR_canopy_metrics/frs_s_mean_tree_height.rds') |> 
  round(2)
pwl_mean_ht <- readRDS('../../analysis/lidar-processing/data/lidR_canopy_metrics/pwl_e_mean_tree_height.rds') |> 
  round(2)

# these data have canopy metrics even where we do not have snow depths...
nadir_cc <-
  readRDS('../../analysis/lidar-processing/data/hemi_stats/full_voxrs_not_filtered_to_swe_traj_angle_w_lca_23_072.rds')

ft_cc_nadir <- nadir_cc |>
  filter(plot_name == 'FT') |>
  pull(lca_nadir) |>
  unique() |> 
  round(2)
pwl_cc_nadir <- nadir_cc |>
  filter(plot_name == 'PWL') |>
  pull(lca_nadir) |>
  unique() |> 
  round(2)

# determine the fraction of canopy height the select wind speed height is

ws_pars <- readRDS('../snow-int-paper/data/model_results/wind_speed_height_match_hemi_traj.rds')
ws_pars$mean_cpy_height <- c(pwl_mean_ht, ft_mean_ht)
ws_pars$frac_cpy_height_off_snow <- ws_pars$wind_height_of_event/ws_pars$mean_cpy_height
ws_pars$ht_above_ground <- ws_pars$event_mean_snow_depth+ws_pars$wind_height_of_event
ws_pars$frac_cpy_height_off_ground <- ws_pars$ht_above_ground/ws_pars$mean_cpy_height

pwl_best_wind <- ws_pars$best_wind[ws_pars$plot == 'PWL'] |> round(2)
ft_best_wind <- ws_pars$best_wind[ws_pars$plot == 'FT'] |> round(2)
pwl_wind_height_off_snow <- ws_pars$wind_height_of_event[ws_pars$plot == 'PWL'] |> round(2)
ft_wind_height_off_snow <- ws_pars$wind_height_of_event[ws_pars$plot == 'FT'] |> round(2)
pwl_wind_height_off_ground <- ws_pars$ht_above_ground[ws_pars$plot == 'PWL'] |> round(2)
ft_wind_height_off_ground <- ws_pars$ht_above_ground[ws_pars$plot == 'FT'] |> round(2)
pwl_frac_cpy_height_off_ground <- ws_pars$frac_cpy_height_off_ground[ws_pars$plot == 'PWL'] |> round(2)
ft_frac_cpy_height_off_ground <- ws_pars$frac_cpy_height_off_ground[ws_pars$plot == 'FT'] |> round(2)
event_sd <- ws_pars$event_mean_snow_depth |> mean() |> round(2)

# met of the snowfall periods
sf_event_avgs <- readRDS('../snow-int-paper/data/event_avgs_maxmin.rds')
sf_event_t_range <- c(min(sf_event_avgs$min_t), max(sf_event_avgs$max_t)) |> round(2)
sf_event_u_range <- c(min(sf_event_avgs$min_u), max(sf_event_avgs$max_u)) |> round(2)
# sf_event_ip_range <- c(min(sf_event_avgs$min_IP_troughs), max(sf_event_avgs$max_IP_troughs))

```

**Authors:**

A. Cebulski^1^ (ORCID ID - 0000-0001-7910-5056)

J.W. Pomeroy^1^ (ORCID ID - 0000-0002-4782-7457)

^1^Coldwater Laboratory, University of Saskatchewan, Canmore, Canada

**Corresponding Author:** A. Cebulski, alexcebulski@gmail.com

**Abstract:** Subcanopy snow accumulation models differ in how snow interception and ablation processes are represented and have uncertain applicability across diverse climates and forest types. Existing parameterizations of initial snow interception before unloading include inherently coupled accumulation and ablation processes, leading to difficulty in diagnosing processes and adding uncertainty to simulations when incorporated as canopy accumulation routines in models that already account for canopy snow ablation. This study evaluates the theory underpinning these parameterizations in-situ meteorological data, high-temporal resolution point-scale throughfall measurements, and fine-scale aerial lidar measurements of throughfall and canopy metrics collected from two subalpine forest plots in the Canadian Rockies. Contrary to existing theories, no association of canopy snow load or air temperature with interception efficiency was observed. Instead, forest structure emerged as the primary factor governing snow accumulation at the forest plot scale. A wind-driven snowfall event demonstrated that non-vertical hydrometeor trajectories significantly reduced throughfall depths across both forest plots. Prediction of interception efficiency for this event improved drastically when adjusted for hydrometeor trajectory angle based on a wind speed at one-third of the canopy height. Snow-leaf contact area showed high sensitivity to wind speed, increasing by up to 95% with a 1 m s^-1^ wind speed. The study proposes two new equations which model snow interception efficiency as a function of snow-leaf contact area adjusted for hydrometeor trajectory angle. This new parameterization successfully estimated interception efficiency for a snowfall event for the two forest plots in this study. By removing canopy snow ablation processes, this new model should offer improved performance in prediction of sub-canopy snow accumulation when combined with canopy snow ablation parameterizations.

**Keywords:** snow interception, throughfall, ablation, forest, snowpack, lidar, process-based modelling

## Introduction

The objective of this paper is to evaluate the theory underlying existing snow interception models using high spatial and temporal resolution measurements of subcanopy snow accumulation events with minimal ablation processes. These new observations are investigated to address the following research questions: 

  1. Are the existing theories regarding the relationship between meteorology and forest structure with snow interception supported by in-situ observations? 

  2. How is snow interception influenced by non-vertical hydrometeor trajectory angles over a wind-driven snowfall event?

  3. To what extent can these findings inform the development of a new parameterization for snow interception?

## Theory

### Snow Interception

During calm snowfall periods, where ablation processes can be assumed negligible, the canopy snow load, $L$ (kg m^-2^) can be estimated as a mass balance:

$$
\frac{dL}{dt} = q_{sf}-q_{tf}
$$ {#eq-dwdt-ode}

where $q_{sf}$ is the snowfall rate (kg m^-2^ s^-1^) and $q_{tf}$ is the throughfall rate (kg m^-2^ s^-1^). This method avoids the influence of sublimation losses or drip from weighed tree lysimeters. 

Interception efficiency, $\frac{I}{P}$ (-), which is the fraction of snow intercepted over $\Delta t$ was calculated as:

$$
\frac{I}{P} = \frac{\frac{dL}{dt}}{q_{sf}}
$$ {#eq-ip}

Throughfall, $q_{tf}$ was be calculated as:

$$
q_{tf} = \left(1 - \frac{I}{P} \right) \cdot q_{sf}
$$ {#eq-event-tf}

### Hydrometeor Trajectory Angle

The trajectory angle, $\theta_h$ of a hydrometeor as the departure in degrees (°) from a vertical plane (i.e., 0° for vertical snowfall), is shown in @Herwitz1995 to be calculated as:

$$
\theta_h = \arctan \left(\frac{x_h(u_z)}{v_h(D_h)}\right)*\frac{180}{\pi}
$${#eq-ta}

where $v_h(D_h)$ is the terminal fall velocity of the hydrometeor (m s^-1^), which is a function of the hydrometeor diameter, $D_h$ and $x_h(u_z)$ is the horizontal change in the hydrometeor (m s^-1^) which is a function within canopy wind speed, $u_z$ at height above ground, $z$. 

## Data and Methods

### Study Site

![Map showing the location of forest plots, flux towers, SCL instruments and survey transects. Inset map on the lower right shows the regional location of Fortress Mountain Research basin.](../../snow-int-paper/figs/maps/site_map_inset.png){#fig-site-map}

### Meteorological Measurements

### Lysimeter Data

![Images of the three subcanopy lysimeters (SCL) and surrounding canopy located in sparse (A), mixed (B), and dense (C) canopy. The top row presents a side view of each SCL and the bottom row shows hemispherical photographs classified using the hemispheR R package. These hemispherical images are oriented with north at the top and have been flipped to provide a view from above (i.e., east is on the right side of each image).](../../snow-int-paper/figs/site-photos/scl_w_fisheye_text.png){#fig-scl-imgs}

### UAV-Lidar Data Collection Processing

### Snow Surveys

#### In-situ Snow Depth and Density

#### UAV-Lidar Snow Depth

### UAV-Lidar Canopy Metrics

### Statistics and Regression Models 

## Results

### The influence of meteorology on snow interception

@fig-scl-w-sf plots canopy snow load against cumulative snowfall over 26 snowfall events using the three SCLs and the PWL snowfall gauge. The duration and meteorology of each snowfall event is summarized in @tbl-sf-event-met and shows air temperature over these periods ranged from a minimum of `r sf_event_t_range[1]` to a maximum of `r sf_event_t_range[1]`°C. Wind speeds ranged from a minimum of `r sf_event_u_range[1]` to a maximum of `r sf_event_u_range[1]` with wind direction that was predominately from the southwest [@fig-wind-rose]. Canopy snow load was observed in @fig-scl-w-sf to increase linearly with increasing snowfall without evidence of reaching a maximum. Variation in the slope of each line in @fig-scl-w-sf, is attributed to differences in the meteorology and antecedent canopy snow load within and between the individual events.

![Plot showing the cumulative event snowfall versus the corresponding state of canopy snow load calculated using the SCLs for each of the 26 snowfall events. The SCLs are denoted by a distinct colour (grey, yellow, and green), correspond to varying canopy coverage (0.73, 0.78, and 0.82, respectively).](../../snow-int-paper/figs/automated_snowfall_event_periods/cuml_event_snowfall_canopy_storage_sep_scl.png){#fig-scl-w-sf}

```{r tbl-sf-event-met, echo=FALSE}
#| label: tbl-sf-event-met
#| tbl-cap: "Meteorological statistics for the 26 snowfall events."

# pretty_table <- readRDS('../../snow-int-paper/data/event_avgs_maxmin_pretty_gt_table.rds')
# pretty_table
# # gt::as_raw_html(pretty_table)

knitr::include_graphics('../snow-int-paper/figs/event_avgs_maxmin_pretty_gt_table_screenshot.png')
```

![Wind rose showing the frequency of wind speed and direction over the 26 snowfall periods for the ultrasonic anemometer 4.3 m above ground at FT station.](../../snow-int-paper/figs/automated_snowfall_event_periods/ft_wind_rose_allevents_snowing_custom_dimensions.png){#fig-wind-rose width=60%}

@fig-scl-ip-avg-event shows mean event air temperature had a weak negative association (*p* < 0.05) with mean event interception efficiency, while the other two troughs displayed insignificant relationships (*p* > 0.05). Cumulative event snowfall had a consistent negative association with cumulative snowfall, however the relationships were insignificant for all three troughs (*p* > 0.05). Event mean wind speed exhibited a relatively strong positive association with interception efficiency for the sparse (*p* > 0.05) and closed (*p* < 0.05) SCLs. A negative insignificant association was observed for the mixed SCL (*p* > 0.05). The opposing relationship of wind speed and interception efficiency between the SCLs can be explained as the mixed SCL has an opening in the canopy [@fig-scl-imgs, B], that matches the prevailing wind direction shown in @fig-wind-rose, thus increasing the amount snowfall entering the sub-canopy during increased winds. For the closed and sparse SCLs this increase in interception efficiency is interpreted to be due to an associated increase in canopy contact area as hydrometeor trajectory becomes more horizontal with increasing wind speed.

![Scatter plots showing the mean air temperature and wind speed and total cumulative snowfall versus the mean interception efficiency measured by the SCLs for each of the 26 snowfall events. The SCLs are denoted by a distinct colour (grey, yellow, and green), correspond to varying canopy coverage (0.73, 0.78, and 0.82, respectively). A linear regression line fit to the data is shown by the solid coloured lines and the corresponding adjusted r squared value. Significant relationships (p < 0.05) are marked by an asterisk beside the R^2^ value.](../../snow-int-paper/figs/automated_snowfall_event_periods/event_avg_temp_wind_cuml_snow_vs_IP_colour_troughs.png){#fig-scl-ip-avg-event}

```{r scl-data, include = F}
mean_ip_by_trough <- readRDS('../snow-int-paper/data/mean_ip_by_trough.rds')

mean_ip_sparse <- mean_ip_by_trough$IP[mean_ip_by_trough == 'sparse_forest'] |> round(2)
mean_ip_med <- mean_ip_by_trough$IP[mean_ip_by_trough == 'mixed'] |> round(2)
mean_ip_dense <- mean_ip_by_trough$IP[mean_ip_by_trough == 'dense_forest'] |> round(2)
```

@fig-lai-met-ip shows the association between interception efficiency measured by the three SCLs and the corresponding air temperature, wind speed, canopy snow load for the same 15-minute time interval. Panel A in @fig-lai-met-ip shows that 15-minute average air temperature measurements has a very low correlation (R^2^ < 0.032) with interception efficiency for all three SCLs with significant relationships (*p* < 0.05) only for the sparse and mixed troughs. The average interception efficiency observed within air temperature bins also does not exhibit any visual trend. However, a significantly greater median interception efficiency (*p* < 0.05) was found for air temperatures below -6 °C compared to colder air temperatures using non-parameteric Wilcoxon signed rank test.

![Scatter plots of discrete observations (blue dots) and binned data (black dots with error bars) of meteorology, canopy load, and hydrometeor characteristics versus snow interception efficiency. Panels show (A) air temperature, (B) relative humidity, (C) wind speed, (D) initial canopy snow load (the snow load observed at the beginning of the timestep), (E) hydrometeor diameter, (F) hydrometeor velocity. The black open circles show the mean of each bin and the error bars represent the standard deviations. The data were filtered to include observations with a snowfall rate > 0 kg m^-2^ hr^-1^, throughfall rate > 0.05 kg m^-2^ hr^-1^ to minimize noise and a snowfall rate > the subcanopy lysimeter throughfall rate to minimize observations with unloading. Periods of unloading and melt were also removed through careful analysis of the weighed tree, subcanopy lysimeters, and timelapse imagery.](../../snow-int-paper/figs/automated_snowfall_event_periods/troughs_met_vs_IP_bin.png){#fig-lai-met-ip}

Panel B in @fig-lai-met-ip shows that wind speed measured at FT Station had a slightly stronger correlation with interception efficiency with R^2^ ranging between 0.04 and 0.09 (*p* < 0.05 for all three SCLs) compared to the association with air temperature. The association between wind speed and interception efficiency was observed to be positive for the sparse and closed SCLs, while the mixed SCL exhibited a negative association. The opposing trend observed for the closed and sparse SCLs compared to the mixed SCL is consistent with the trend observed in @fig-scl-ip-avg-event for the event means and is also attributed to a change in snow-leaf contact area with shifting hydrometeor trajectories as a result of changing wind speed. Between wind speed bins of 0.25 and 2.75 m s^-1^ the mean interception efficiency increased from 0.58 to 0.66 and 0.48 to 0.61 for the closed and sparse forest SCLs respectively (@fig-lai-met-ip, B). The mixed SCL declined from 0.59 to 0.45 for the same range in wind speed bins. A comparison interception efficiency between low (< 1 m s^-1^) and high (> 1 m s^-1^) wind speeds by the Wilcoxon signed rank test showed that high wind speeds had significantly higher (*p* < 0.05) median interception efficiency compared to the low wind speed group for the closed and sparse SCL. Conversely, the Wilcoxon test showed the mixed SCL had significantly higher (*p* < 0.05) median interception efficiency for the low wind speed group. 

@fig-lai-met-ip, panel C shows canopy snow load, measured at the beginning of each timestep, shows a relatively weak significant negative relationship between the 15-minute observations (R^2^ < 0.4, *p* < 0.05) for the closed and sparse SCLs and a non-significant relationship was observed for the mixed SCL. The binned data show a small increase in interception efficiency was observed for all three troughs between canopy snow loads of 0 kg m^-2^ to 7 kg m^-2^. This was followed by a gradual decline in interception efficiency for snow loads greater than 7 kg m^-2^ with the closed and sparse SCL (@fig-lai-met-ip, C). The interception efficiency measured by the mixed SCL also declines above 7 kg m^-2^ before increasing again around 16 kg m^-2^ and then declines again to a minimum interception efficiency of 0.39. A comparison of low (< 10 kg m^-2^) and high (> 10 kg m^-2^) canopy snow loads using the Wilcoxon rank-test showed the low canopy snow loads had significantly greater (*p* < 0.05) median interception efficiency compared to the high canopy snow load group. The location of the SCLs within gaps in the canopy may have contributed to these instruments registering a slight increase in interception efficiency as small branch gaps are covered by snow followed by a decline in interception efficiency as branches bend due to the weight of snow intercepted on the branch compressing it downwards and thus reducing the canopy coverage above the SCLs.

### The influence of forest structure on snow interception

```{r ta-calcs, include=FALSE}
source('../../analysis/disdrometer/scripts/00_source_functions.R')

# MET
event_avg_met <- readRDS('../snow-int-paper/data/event_met/lidar_events_met_avg.rds') |> 
  filter(event_id == '2023-03-14')
event_sf <- event_avg_met |> pull(`Cuml. Snowfall (mm)`) |> round(1)
snowing_met <- readRDS('../snow-int-paper/data/event_met/lidar_events_met_avgs_snowing.rds') |> 
  filter(event_id == '2023-03-14')

ft_ws_avg <- snowing_met |> 
  pull(`mean FT Wind Speed (m/s)`) |> 
  round(2)
pwl_ws_avg <- snowing_met |> 
  pull(`mean PWL Wind Speed (m/s)`) |> 
  round(2)
wd <- snowing_met |> 
  pull(`mean FT Wind Dir. (°)`) |> 
  round()
hm <- 0.9 # mean measured event parsivel
ft_ta <- traj_angle_deg(ft_ws_avg, hm) |> 
  round(0)
pwl_ta <- traj_angle_deg(pwl_ws_avg, hm) |> 
  round(0)

# HEMI STATS

# first found the theta range which corresponded to the upper 97.5th percentile of rho values
vox_config_id <- "23_072_vox_len_0.25m_sa_gridgen_v2.0.0_sa"
pwl_hemi_stat <-
  readRDS(
  paste0(
    '../../analysis/lidar-processing/data/hemi_stats/hemi_raw_theta_phi_for_rho_s_upper_2_5th_percentile_',
    vox_config_id,
    "_",
    'PWL_E',
    '.rds'
  ))

ft_hemi_stat <-
  readRDS(
  paste0(
    '../../analysis/lidar-processing/data/hemi_stats/hemi_raw_theta_phi_for_rho_s_upper_2_5th_percentile_',
    vox_config_id,
    "_",
    'FSR_S',
    '.rds'
  ))


pwl_theta_to <- max(pwl_hemi_stat$theta_d) |> round()
ft_theta_to <- max(ft_hemi_stat$theta_d) |> round()
pwl_theta_from <- min(pwl_hemi_stat$theta_d) |> round()
ft_theta_from <- min(ft_hemi_stat$theta_d) |> round()

# then found the phi which had the best rho based on the theta range above
cor_stats <-
  readRDS('../../analysis/lidar-processing/data/hemi_stats/r2_vs_integrated_and_single_zentith.rds')
# find the zenith corresponding to the highest R value
cor_smry <- cor_stats |>
  group_by(plot_name, group) |>
  summarise(
    rp = max(rp),
    peak_r2 = max(r2),
            phi_at_peak_r2 = phi_d[which.max(r2)])

pwl_best_phi_rho <- cor_smry$rp[cor_smry$plot_name == 'PWL' & cor_smry$group == 'Single Zenith']  |> round(2)
ft_best_phi_rho <- cor_smry$rp[cor_smry$plot_name == 'FT' & cor_smry$group == 'Single Zenith'] |> round(2)

pwl_best_phi <- cor_smry$phi_at_peak_r2[cor_smry$plot_name == 'PWL' & cor_smry$group == 'Single Zenith']
ft_best_phi <- cor_smry$phi_at_peak_r2[cor_smry$plot_name == 'FT' & cor_smry$group == 'Single Zenith']

# model error stats
mod_error <- readRDS('../../analysis/lidar-processing/data/models/lca_vs_ip_model_error_ft_pwl_nadir_adj.rds')

ft_a_val <- mod_error$`Model Slope`[mod_error$`Plot Name` == 'FT' & mod_error$`Canopy Metrics` == 'Vector Based'] |> round(2)
pwl_a_val <- mod_error$`Model Slope`[mod_error$`Plot Name` == 'PWL' & mod_error$`Canopy Metrics` == 'Vector Based'] |> round(2)
ft_r2_val <- mod_error$R2_adj[mod_error$`Plot Name` == 'FT' & mod_error$`Canopy Metrics` == 'Vector Based'] |> round(2)
pwl_r2_val <- mod_error$R2_adj[mod_error$`Plot Name` == 'PWL' & mod_error$`Canopy Metrics` == 'Vector Based'] |> round(2)
pwl_a_val_nadir <- mod_error$`Model Slope`[mod_error$`Plot Name` == 'PWL' & mod_error$`Canopy Metrics` == 'Nadir'] |> round(2)
ft_a_val_nadir <- mod_error$`Model Slope`[mod_error$`Plot Name` == 'FT' & mod_error$`Canopy Metrics` == 'Nadir'] |> round(2)
pwl_r2_val_nadir <- mod_error$R2_adj[mod_error$`Plot Name` == 'PWL' & mod_error$`Canopy Metrics` == 'Nadir'] |> round(2)
ft_r2_val_nadir <- mod_error$R2_adj[mod_error$`Plot Name` == 'FT' & mod_error$`Canopy Metrics` == 'Nadir'] |> round(2)

ft_10m_example <- readRDS('../snow-int-paper/data/event_met/ft_20230313_wind_speed_traj_angle_10m.rds')
ft_2m_example <- readRDS('../snow-int-paper/data/event_met/ft_20230313_wind_speed_traj_angle_2m.rds')
ft_mean_wind_prof_integral <- readRDS('../snow-int-paper/data/event_met/ft_20230313_mean_integral_wind_profile_and_traj.rds')
ft_mean_wind_speed_prof_integral <- ft_mean_wind_prof_integral$wind_speed |> round(2)

```

UAV-lidar measurements of throughfall and canopy structure metrics provide insights on how the forest canopy influenced subcanopy snow accumulation during a wind-driven snowfall event between March 13th and 14th. This event totaled `r event_sf` kg m^-2^ of snowfall at PWL station and was characterized by a transition from low rates of snowfall and air temperature near 0°C to higher rates of snowfall late afternoon on March 13 coinciding with air temperatures around -2.5 °C. An average wind speed of 1.27 m s^-1^ and direction of 188° was observed 4.3 m above the ground at FT Station. A logarithmic wind speed profile shown in @fig-wind-profiles provided a good fit to observed wind speeds at 2, 3, 4.3 and 13.5 m above the ground and shows the @Cionco1965 exponential function was not appropriate for the sparse canopy surrounding FT station. The heavy snowfall over this event covered the two eddy covariance systems at FT station with snow limiting wind speed measurements to test this wind speed profile at different heights or provide a measurement of friction velocity for this event. @fig-wind-profiles shows predicted hydrometeor trajectory angles at varying heights, calculated using @eq-ta and the mean observed hydrometeor terminal velocity observed over the event of, 0.9 m s^-1^. An average wind speed of `r ft_mean_wind_speed_prof_integral` m s^-1^ and direction of 188° was calculated by integrating the wind speed from the surface to the mean canopy height of FT plot. The corresponding trajectory angle, calculated using @eq-ta, from this integrated wind speed was `r ft_mean_wind_prof_integral$traj_angle |> round(2)`°.

![Wind speed profile fit to roughness length and displacement height parameters derived from anemometors at 2, 3, 4.3, and 13.5 m above ground at FT station and friction velocity observed over the March 13-14th snowfall event. The red triangle shows the mean observed wind speed at 4.3 m measured at FT station over the March 13-14 snowfall event.](../snow-int-paper/figs/lidar_periods/wind_profile_w_trajectories_20230313.png){#fig-wind-profiles}

UAV-lidar measurements of throughfall shown in @fig-lidar-tf-ip aligned well with 28 in-situ manual throughfall measurements with a mean bias of -0.001 m and RMSE of 0.024 m. The mean bias between these two measurements were observed to be similar within canopy gaps and within tree wells, while tree wells resulted in a larger percent bias. All three SCLs and the weighed tree registered a 2 kg m^-2^ unloading event during a brief pause in snowfall early in the morning on March 14, prior to the UAV-lidar flight. This unloading event in addition to the moderate wind speeds observed during the snowfall event likely contributed to some redistribution of snow on the ground. The relatively small unloading event compared to the amount of snow that fell during the snowfall event and minimal evidence of observed wind redistribution on the ground is inferred to have not significantly altered the UAV-lidar throughfall measurements.

@fig-lidar-tf-ip shows the spatial distribution of throughfall and interception efficiency at the PWL and FT forest plots. Reduced throughfall and greater interception efficiency is observed on the north (lee) side of individual trees, which is interpreted to be a result of non-vertical hydrometeor trajectories caused by the steady southerly winds observed over this event. In-situ visual observations on March 13th and 14th confirmed non-vertical hydrometeor trajectories and increased canopy snow loads were observed on the windward side of individual trees. This effect is shown in @fig-lidar-tf-ip to be more apparent within the PWL forest plot, compared to the FT forest plot. This may be attributed to the taller trees and higher canopy coverage within the PWL forest plot compared to the FT forest plot, where given the same trajectory angle a taller tree will produce a larger footprint.

![UAV-lidar measurements of the change in SWE (kg m^-2^) and interception efficiency over the March 13, 2023 24 hr snowfall event for the FT and PWL forest plots at a 25 cm resolution. Transparent areas represent grids that did not have any lidar ground returns (i.e., under dense canopy proximal to tree trunks) or have been masked due to disturbance. See the location of the two forest plots within FMRB in @fig-site-map.](../../analysis/lidar-processing/figs/maps/facet_ft_pwl_23_072_23_073_v2.0.0_saswe_and_ip_normalised_resample_0.25.png){#fig-lidar-tf-ip}

@fig-hemi-ip-cc presents two hemisphere plots which illustrate the correlation between $C_p$ and interception efficiency at a 0.25 m horizontal grid cell resolution over differing azimuth and zenith angles for both the FT and PWL forest plots. These plots demonstrate a strong linear correlation between $C_p$ and interception efficiency towards the southern portion of the hemisphere, aligning with the average event wind direction. For the PWL forest plot, the upper 97.5th percentile of the $\rho_p$ values shown in @fig-hemi-ip-cc, were found between azimuth angles of `r pwl_theta_from`° – `r pwl_theta_to`°. Similarly, for the FT forest plot, the upper 97.5th percentile of $\rho_p$ was found between azimuth angles of `r ft_theta_from`° – `r ft_theta_to`°. The zenith angle found to have the highest correlation over this azimuth range was `r pwl_best_phi`° ($\rho_p$ = `r pwl_best_phi_rho`) and `r ft_best_phi`° ($\rho_p$ = `r ft_best_phi_rho`) for PWL and FT respectively. The high correlation coefficients found for non-vertical zenith angles for both PWL and FT are believed to result from non-vertical hydrometeor trajectories. At near-nadir zenith angles, @fig-hemi-ip-cc illustrates slightly lower $\rho_p$. In addition to the inclined hydrometeor trajectories, this may be influenced by reduced UAV-lidar returns, as shown in @fig-lidar-tf-ip, and higher percent error proximal to the trunks of individual trees due to reduced throughfall depths. However, this limitation does not significantly alter the interpretation of the results. 

![The Pearson Correlation Coefficient between rasters (25 cm resolution) of interception efficiency and leaf contact area for each grid cell across the study site for each azimuth angles (0°, 1°, ..., 359°) and zenith angles (0°, 1°, ..., 90°) for the FT (left) and PWL (right) forest plots.](../../analysis/lidar-processing/figs/voxrs/hemis/full_hemi_rho_p_cor_lca_ip_23_072_vox_len_0.25m_sa_gridgen_v2.0.0_sa_ft_pwl_.png){#fig-hemi-ip-cc}

@fig-lca-vs-ip shows that the correlation between $C_p$ and interception efficiency, resampled to a 5 m resolution, is stronger when $C_p$ is adjusted for the observed shift in hydrometeor trajectory (Vector Based), compared to the nadir leaf contact angle (zenith angle of 0°). The strong association suggests that adjusted $C_p$ is a useful predictor of interception efficiency, before ablation. For the vector-based model, adjusted $C_p$ was calculated using the VoxRS dataset corresponding to the azimuth range and zenith angle with the highest $rho_p$ for each plot as mentioned in the previous paragraph. An ordinary least squares linear regression forced through the origin was fit to the observed data points using the following equation:

$$
  \frac{I}{P} = C_p(C_c, \theta_h) \cdot \alpha
$${#eq-lca-ip}

where $\alpha$ is an efficiency constant which determines the fraction of snowflakes that contact the $C_p$ elements and are stored in the canopy (i.e., intercepted) before canopy snow unloading or ablation processes begin.

![Scatter plots showing the relationship between leaf contact area and interception efficiency rasters resampled to a 5 m grid cell resolution. The left plot (Nadir) shows leaf contact area measured from a zenith angle of 0°. The right plot (Vector Based) shows the leaf contact area averaged over rasters with zenith angles (PWL = 22°, FT = 21°) and azimuth angles (PWL = 167°, 178°, ... 217°; FT = 171°, 172°, ... 223°). The solid lines (Model fit) show the ordinary least squares linear regression forced through the origin and fitted to the PWL (red) and FT (black) data and the light grey dotted line shows a 1:1 line. The R^2^ values for the four different models are shown in the upper right of each panel calculated following the methods outlined in @Kozak1995.](../../analysis/lidar-processing/figs/voxrs/scatter/pwl_ft_lca_vs_ip_phi_nadir_adjusted_resample_w_mods_5m.png){#fig-lca-vs-ip}

The Nadir linear regression model provides a good overall fit to the observed data and closely follows the 1:1 line in @fig-lca-vs-ip, with a $\alpha$ value of `r pwl_a_val_nadir` and `r ft_a_val_nadir` for the PWL and FT plot respectively. For the PWL plot, the observed points follow a linear relationship until a $C_p$ value of around 0.50 after which the increase in interception efficiency plateaus. After the @Kozak1995 adjustment a negative R^2^ value was determined for the PWL plot. Some of the scatter observed in the Nadir model shown in @fig-lca-vs-ip may be explained by grid cells which observed a greater interception efficiency compared to the corresponding $C_c$ value and can be attributed to the inability of $C_c$ to represent the increase in interception observed within canopy gaps in @fig-lidar-tf-ip. Conversely, for grid cells where interception efficiency is less than $C_c$, may be attributed to non-vertical trajectory hydrometeors making their way underneath the canopy as observed by the reduced interception efficiency on the windward edges of individual trees in @fig-lidar-tf-ip. This later explanation explains the non-linear relationship observed for the PWL Nadir model in @fig-lidar-tf-ip.

For the vector-based model, the relationship between interception efficiency and $C_p$ is better represented by a linear regression model for both plots with R^2^ values of `r pwl_r2_val` and `r ft_r2_val` for PWL and FT respectively. The increase in interception efficiency with $C_p$ follows a reduced slope compared to the Nadir models with $\alpha$ values of `r pwl_a_val` and `r ft_a_val` for the PWL and FT plots respectively. The reduced slope for the vector-based models may be attributed to snowflakes that weaved through and/or bounced off branch elements in addition to some of the UAV-lidar measurement uncertainty which contained some unloading and redistribution. These processes would have reduced the fraction of snowfall that contacted the canopy that was intercepted.

Model error statistics are presented in @tbl-ip-mod-err for the Nadir and vector-based models and show the vector-based model provides a better prediction of interception efficiency. The vector-based model reduced the RMSE from 0.099 to 0.062 for the FT plot and 0.146 to 0.095 for the PWL plot. The good model performance shown for the vector-based model demonstrates that using $C_p$ adjusted for observed event hydrometeor trajectory angle has the potential to be a predictor of interception efficiency, before ablation. However, the detailed point clouds required to derived the $C_p$ values used in this analysis are rarely available and thus more accessible methods to estimate $C_p$ must be obtained in order to use @eq-lca-ip. 

```{r tbl-ip-mod-err, echo=FALSE}
#| label: tbl-ip-mod-err
#| tbl-cap: "Model error statistics provided for predictions of interception efficiency using @eq-lca-ip and for different $a$ values, as shown in the Model Slope column. Statistics are provided for the PWL and FT forest plots, using leaf contact area canopy metrics adjusted to zenith angles of (0°, 1°, ... 30°) and azimuth angles (170°, 171°, ... 220°) and nadir zenith angle of 0°. The Mean bias is the difference in the model and observed values, MAE is the mean of the absolute error, RMS Error is the root mean squared error, R^2 is the coefficient of determination adjusted using Equation 10 in @Kozak1995."

mod_error |> 
  rename(`R^2` = R2_adj) |> 
  select(-R2_base) |> 
  knitr::kable()
  # knitr::kable(booktabs = TRUE,
  #              format = 'latex')

```

### The combined influence of trajectory angle and forest structure on interception

```{r forest-structure-calcs, include=FALSE}
library(dplyr)
hemi_stats <- readRDS('../../analysis/lidar-processing/data/hemi_stats/full_voxrs_not_filtered_to_swe_traj_angle_w_lca_23_072.rds') |> 
  mutate(find_wind = abs(1-wind_speed))

select_wind_speed <- 1
pwl <- hemi_stats |> filter(plot_name == 'PWL')
ft <- hemi_stats |> filter(plot_name == 'FT')
pwl_inc <- pwl$lca_inc[which.min(abs(select_wind_speed-pwl$wind_speed))]
ft_inc <- ft$lca_inc[which.min(abs(select_wind_speed-ft$wind_speed))]
ta <- pwl$traj_angle[which.min(abs(select_wind_speed-pwl$wind_speed))]

pwl_nadir <- pwl$lca_nadir |> unique()
ft_nadir <- ft$lca_nadir |> unique()
pwl_perc_inc <- pwl_inc / pwl_nadir * 100
ft_perc_inc <- ft_inc / ft_nadir * 100

pwl_nls_coefs <- readRDS('../../analysis/lidar-processing/data/models/ta_vs_lca_nls_coefs_pwl.rds')
ft_nls_coefs <- readRDS('../../analysis/lidar-processing/data/models/ta_vs_lca_nls_coefs_pwl.rds')


ft_wp_pars <- readRDS(
  '../../analysis/eddy-cov/data/forest_tower_wind_profile_params_clean_ec_events.rds'
) |> select(-ustar) # need to calculate based on the event wind speed


```

@fig-lca-ht-ws shows that $C_p$, measured from VoxRS prior to snowfall on March 13th, increases substantially with the simulated hydrometeor trajectory angle and corresponding simulated wind speed. The standard deviation in VoxRS measured $C_p$, illustrated by the shaded area in @fig-lca-ht-ws exhibits the large range in values for individual grid cells across each forest plot. Despite this large scatter, a systematic increase in the plot mean $C_p$ results from a rise in the number of canopy elements for more horizontal portions of the hemisphere, when averaged across each forest plot, over all azimuth angles (see solid lines top row, @fig-lca-ht-ws). The increase in $C_p$ from $C_c$ (i.e., $C_p - C_c$), with increasing trajectory angle is shown on the bottom row of @fig-lca-ht-ws and exhibits a similar relationship for both forest plots FT and PWL until trajectory angles reach approximately 60°. Beyond 60°, the PWL rate of increase slows as the $C_p$ approaches .90 around 60°, while the FT plot, which has lower $C_c$, continues to rise quickly until around 75° afterwards the slope is reduced as a $C_p$ of one is approached.

<!-- These figures are generated under the lidar-processing project using scripts 11-13. Recently sped up the processing for these and can now be run locally. -->

![Plots showing the relationship between hydrometeor trajectory angle (left) and wind speed (right) with mean plot-wide snow-leaf contact area, $C_p$ (top row) and the increase in mean plot-wide $C_p$, i.e., $C_p - C_c$ (bottom row). Simulated hydrometeor trajectory angle is measured as degrees from zenith. Simulated wind speed was calculated as a function of hydrometeor trajectory angle by rearranging @eq-ta and an observed event hydrometeor velocity of 0.9 m s^-1^. The solid lines (VoxRS) represent the mean $C_p$ (top) or increase in mean $C_p$ (bottom) for a single zenith angle observed from VoxRS across all grid cells for each forest plot and across all azimuth angles. The shaded area represents 1 standard deviation above and below the observed VoxRS mean. The dashed lines (Fitted) represent predictions from @eq-lca-ac (top) and @eq-lca-inc (bottom). The dotted lines (HP98) represent the predictions from Equation 10 in @Hedstrom1998a. A forested downwind distance of 100 m was used for the HP98 calculation. The line colour represents the forest plot, FT (black) and PWL (red)](../../analysis/lidar-processing/figs/voxrs/scatter/WITH_TREEWELLS_traj_angle_and_wind_phiby_1_thetaby_2_traj_angle_wind_speed_vs_cowplot_lca_and_inc_w_mods_mean_sd_23_072.png){#fig-lca-ht-ws}

At the stand scale, increasing the hydrometeor trajectory angle results in a large rise in the VoxRS measured $C_p$ over relatively common estimated wind speeds. For example, with a wind speed of `r select_wind_speed` m s^-1^ and estimated trajectory angle of `r ta |> round(0)`°, the $C_p$ increased by a fraction of `r pwl_inc |> round(2)` and `r ft_inc |> round(2)` for the PWL and FT forest plots respectively in @fig-lca-ht-ws (right panel). This is a percent increase in the plot $C_p$ from nadir of `r pwl_perc_inc |> round(0)`% and `r ft_perc_inc |> round(0)`% for PWL and FT respectively. A similar rate of increase in $C_p$ was observed between both the FT and PWL forest plots up to around 60° or 1.5 m s^-1^. $C_p$ was also quantified across trajectory angles for both PWL and FT on March 14th, post snowfall, and showed a negligible effect of canopy snow load on $C_p$. 

A function is proposed here that calculates plot scale leaf contact area, $C_p$ (-):

$$
C_p = C_c + C_{inc}(\theta_h)
$${#eq-lca-ac}

where, $C_{inc}$ is the increase in leaf contact area from $C_c$ which is a function of the zenith angle (hydrometeor trajectory) of interest. To estimate $C_{inc}$ a non-linear least squares regression using a logistic function forced through the origin was fit to the VoxRS measurements at FT and PWL for simulated hydrometeor trajectory angles (see dashed lines in bottom row of @fig-lca-ht-ws). The logistic function used predict $C_{inc}$ as a function of $\theta_h$ is:  

$$
C_{inc} = \left(
\frac{C^{max}_{inc}}{1 + e ^ {\left(\frac{\theta_0 - \theta_h}{\text{k}}\right)}} - \frac{C^{max}_{inc}}{1 + e ^ {\left(\frac{\theta_0}{\text{k}}\right)}}
\right)
$${#eq-lca-inc}

where $C^{max}_{inc}$ is the maximum value of $C_{inc}$, $\theta_0$ is the x value of the sigmoid midpoint and $k$ is the logistic growth rate or steepness of the curve. 

The resulting coefficients for $LCA_{max}$, $\theta_0$ and $k$ after the nls fit to the VoxRS dataset `r pwl_nls_coefs['Asym'] |> as.numeric() |> round (3)`, `r pwl_nls_coefs['xmid'] |> as.numeric() |> round (3)` and `r pwl_nls_coefs['scal'] |> as.numeric() |> round (3)` respectively for PWL. For FT the resulting coefficients for $LCA_{max}$, $\theta_0$ and $k$ from nls were `r ft_nls_coefs['Asym'] |> as.numeric() |> round (3)`, `r ft_nls_coefs['xmid'] |> as.numeric() |> round (3)` and `r ft_nls_coefs['scal'] |> as.numeric() |> round (3)` respectively. A logistic function was selected to model this relationship, as its shape was deemed most appropriate to represent the change in $C_p$ with trajectory angle. This choice reflects the observed slow increase in $C_p$ at near vertical trajectory angles. The logistic function also captures the non-linear increase at more horizontal trajectory angles, where snowflakes encounter more canopy area in the middle and lower section of individual trees. Additionally, the function effectively represents the gradual leveling off of $C_p$ as it approaches full coverage (value of one). 

Simulated $C_p$ using @eq-lca-ac is shown in the dashed lines in the top row of @fig-lca-ht-ws and follows closely to the VoxRS measured mean $C_p$. Model error statistics shown in @tbl-lca-mod-err demonstrate that @eq-lca-ac performed well, with a mean bias and RMSE of 0.001 and 0.0054 respectively for PWL, and -0.0004 and 0.0079 for FT. In contrast, @tbl-lca-mod-err reveals that the @Hedstrom1998a method produced significantly less accurate estimates of $C_p$, with a mean bias and RMSE of -0.201 and 0.233 respectively for PWL, and -0.260 and 0.324 for FT.

The use of @eq-lca-inc requires estimates of $\theta_0$ for a snowfall event. The estimated trajectory angle of `r ft_mean_wind_prof_integral$traj_angle |> round(2)`° resulting from the mean wind speed integrated over the canopy height was much higher than the trajectory angle closer to 20° observed in @fig-hemi-ip-cc. Based on the wind speed profile in @fig-wind-profiles a trajectory angle of around 20° would have resulted from a mean wind speed of `r pwl_best_wind` m s^-1^ and `r ft_best_wind` s^-1^ and a height above the snowpack of `r pwl_wind_height_off_snow` m and `r ft_wind_height_off_snow` m for PWL and FT respectively. Based on the event average snowpack depth at FT station of `r event_sd` m, this corresponds to a height above the ground that is `r pwl_wind_height_off_ground` m and `r ft_wind_height_off_ground` m for PWL and FT respectively and fraction of the mean canopy height of `r pwl_frac_cpy_height_off_ground` m and `r ft_frac_cpy_height_off_ground` as a result of the differing tree heights within two plots. This corresponds to roughly one-third the canopy height, based on an average of the two forest plots, to achieve this low wind speed is interpreted to be a result of the conical shape of the needleleaf trees surrounding PWL and FT which have the majority of their canopy volume towards the ground. Although the wind speeds were observed to be higher near the top of the canopy, corresponding to higher trajectory angles, the reduced canopy volume at this height results in a smaller impact of these more horizontal trajectories.

<!-- These figures are generated under the lidar-processing project using scripts 11-13. The original version generated 100 of GB of ram but now has been optimised and can run locally.  -->

```{r tbl-lca-mod-err, echo=FALSE}
#| label: tbl-lca-mod-err
#| tbl-cap: "Model error statistics calculated for the prediction of leaf contact area from trajectory angle using @eq-lca-inc (nls) and Equation 10 from @Hedstrom1998a for the PWL and FT forest plots. Mean bias is the difference in the model and observed values, MAE is the mean of the absolute error, RMS Error is the root mean squared error and R^2 is the coefficient of determination. A forested downwind distance of 100 m was used for the HP98 calculation."

mod_error <- readRDS('../../analysis/lidar-processing/data/models/lca_obs_mod_error_tbl.rds')

mod_error |> 
  rename(`R^2` = `r^2`) |> 
  knitr::kable()
  # knitr::kable(booktabs = TRUE,
  #              format = 'latex')
```

### Throughfall Model Performance

```{r throughfall-calcs, include=FALSE}
vb_plot_scale_err <- readRDS('../snow-int-paper/figs/lidar_periods/23_072_23_073_plot_scale_vb_model_error.rds') |> 
  select(plot,
         val_name = name,
         mod_type,
         obs_val = `UAV-lidar`,
         mod_val = mod_vals,
         `Mean Bias` = bias,
         # MAE,
         `Perc. Error`)

pwl_vb_tf_mod <- vb_plot_scale_err$mod_val[vb_plot_scale_err$plot == 'PWL' & vb_plot_scale_err$mod_type == 'VB-model' & vb_plot_scale_err$val_name == 'tf'] |> round(1)
ft_vb_tf_mod <- vb_plot_scale_err$mod_val[vb_plot_scale_err$plot == 'FT' & vb_plot_scale_err$mod_type == 'VB-model' & vb_plot_scale_err$val_name == 'tf'] |> round(1)
pwl_vb_tf_obs <- vb_plot_scale_err$obs_val[vb_plot_scale_err$plot == 'PWL' & vb_plot_scale_err$mod_type == 'VB-model' & vb_plot_scale_err$val_name == 'tf'] |> round(1)
ft_vb_tf_obs <- vb_plot_scale_err$obs_val[vb_plot_scale_err$plot == 'FT' & vb_plot_scale_err$mod_type == 'VB-model' & vb_plot_scale_err$val_name == 'tf'] |> round(1)

pwl_vb_bias <- vb_plot_scale_err$`Mean Bias`[vb_plot_scale_err$plot == 'PWL' & vb_plot_scale_err$mod_type == 'VB-model' & vb_plot_scale_err$val_name == 'tf'] |> round(1)
ft_vb_bias <- vb_plot_scale_err$`Mean Bias`[vb_plot_scale_err$plot == 'FT' & vb_plot_scale_err$mod_type == 'VB-model' & vb_plot_scale_err$val_name == 'tf'] |> round(1)
pwl_nadir_bias <- vb_plot_scale_err$`Mean Bias`[vb_plot_scale_err$plot == 'PWL' & vb_plot_scale_err$mod_type == 'Nadir-model' & vb_plot_scale_err$val_name == 'tf'] |> round(1)
ft_nadir_bias <- vb_plot_scale_err$`Mean Bias`[vb_plot_scale_err$plot == 'FT' & vb_plot_scale_err$mod_type == 'Nadir-model' & vb_plot_scale_err$val_name == 'tf'] |> round(1)
```

The performance of @eq-lca-ip in estimating event throughfall was assessed for the March 13-14 snowfall event at the plot scale for both FT and PWL. Event throughfall was calculated using @eq-event-tf with interception efficiency modelled from @eq-lca-ip and integrating over the event time interval. The mean hydrometeor terminal velocity and total event snowfall was measured at PWL station, and wind speed was determined at height of one-third the mean canopy height using the wind speed profile in @fig-wind-profiles. Additional model inputs include $C_c$, measured from from UAV-lidar averaged over each forest plot, an $\alpha$ value of 1 was chosen based on the close alignment of interception efficiency and $C_c$ to the 1:1 line in @fig-lca-vs-ip, and the previously defined constants for @eq-lca-inc derived for the PWL and FT plots were incorporated.

Predicted values of observed and modelled interception efficiency and $\Delta SWE_{tf}$ are shown in @tbl-vb-plot-err along with corresponding error statistics. @fig-event-tf shows the vector-based model, computed using @eq-lca-ip with $C_p$ adjusted for estimated hydrometeor trajectory angle, closely matches UAV-lidar measurements of throughfall with a positive mean bias of `r pwl_vb_bias` kg m^-2^ for PWL and `r pwl_vb_bias` kg m^-2^ for FT. @fig-event-tf shows the nadir model, computed using @eq-lca-ip and $C_c$ in place of $C_p$, over predicted throughfall compared to the UAV-lidar measurements with a negative mean bias of `r pwl_nadir_bias` kg m^-2^ for PWL and `r pwl_nadir_bias` kg m^-2^ for FT. @tbl-vb-plot-err shows the vector-based model has a very low absolute percent error compared to the Nadir model for PWL however for FT there is only slight improvement in absolute error. The positive bias was observed for the vector-based model was expected and is preferred compared to the nadir model as the UAV-lidar measurements of throughfall are inherently underestimates since they include some amount of unloading and redistribution. If measurements of throughfall without unloading and redistribution could have been collected it is expected the vector-based model would have further reduced error compared to the Nadir model for both FT and PWL. The improved performance of the vector-based model at PWL compared to FT, may be attributed to increased unloading and redistribution across the FT plot as a result of the sparser wind-exposed canopy. 

![Bar chart comparing the observed and modelled mean change in throughfall (𝚫 SWE, kg m⁻²) over the March 13-14 snowfall event averaged over forest plots FT and PWL. The 'nadir' data type used @eq-lca-ip but was not adjusted for trajectory angle and thus $C_c$ was used instead of $C_p$, 'obs' corresponds to the UAV-lidar measured change in throughfall, and 'VB' is the change in throughfall predicted from the vector-based (VB) model which uses @eq-lca-ip with $C_p$ adjusted for trajectory angle. The black horizontal dashed line shows the accumulated SWE (kg m⁻²) over the snowfall event to the PWL station open clearing.](../snow-int-paper/figs/lidar_periods/23_072_23_073_event_throughfall_totals_obs_vs_vb_vs_nadir.png){#fig-event-tf}

```{r tbl-vb-plot-err, echo=FALSE}
#| label: tbl-vb-plot-err
#| tbl-cap: "Model error statistics for model estimates of snow interception efficiency (ip) and throughfall (tf) compared to measurements of ip and tf using UAV-lidar averaged over the FT and PWL forest plots. Units for ip and tf are (-) and (kg m⁻²) respectively. The 'mod_type' column refers to the method used to estimate ip and tf. The vector-based (VB) method utilized @eq-lca-ip with $C_p$ adjusted for trajectory angle. The nadir method also utilized @eq-lca-ip but was not adjusted for trajectory angle and thus $C_c$ was used instead of $C_p$. The obs_val column contains measurements from UAV-lidar while the mod_val column contains values from the respective mod_type method. The Mean Bias was calculated as observed minus modelled and Perc. Error is the percent error between predicted and observed values."

vb_plot_scale_err  |> knitr::kable(digits = 2)
```

## Discussion

The point scale observations presented in this study showed air temperature had little influence on interception efficiency [@fig-lai-met-ip, A] which differs from existing studies which suggested either a strong positive [@Storck2002] or negative [@Hedstrom1998a] relationship. An increase in initial interception efficiency before unloading was observed with increasing wind speed at two locations which were sheltered to the predominant wind direction [@fig-lai-met-ip, B]. This was attributed to an associated increase in $C_p$ with wind speed. These results are consistent with observations by @Schmidt1989 who observed a slight increase in interception with increasing wind speeds up to 6 m s^-1^. 

Compared to the influence of wind speed, interception efficiency showed a smaller sensitivity to canopy snow load at the point scale [@fig-scl-ip-avg-event]. The slight increase in interception efficiency for smaller canopy snow loads and decline in interception efficiency for larger canopy snow loads is attributed to the influence of canopy snow load on $C_p$ [@fig-lai-met-ip, C]. While small, this effect is like the theory proposed by @Satterlund1967 that interception efficiency increases as the canopy fills with snow bridging gaps in the canopy increasing, while later declining due to branch bending and decreased canopy coverage. The observations presented in @fig-lai-met-ip and @fig-scl-w-sf, differ from the @Satterlund1967, @Hedstrom1998a, @Storck2002 and @Moeser2015 theories, as canopy snow load increased linearly with snowfalls up to 45 kg m^-2^ with no evidence of approaching a maximum canopy snow load. The strong exponential decline in interception efficiency observed with increasing event snowfall in @Satterlund1967, @Hedstrom1998a, @Storck2002 and @Moeser2015 may be a result of increased unloading rates as branches bend under heavy snow loads and hence mix ablation and interception processes to varying degrees. The low sensitivity of interception efficiency with canopy snow load found in this study may be attributed to several factors: a reduced inclusion of ablation processes in the interception efficiency measurements, limited influence of canopy snow load on $C_p$ at this study site, and/or the compensatory effects outlined by @Satterlund1967.

@Staines2023 showed a slight increase in $C_p$ between snow-off conditions from a single UAV-lidar scan compared to snow-on conditions derived from a combination of three UAV-lidar scans. The higher forest density in the @Staines2023 study resulted in less canopy gaps and was thus not as influenced by branch bending. This may have resulted in a slightly higher influence of snow load on $C_p$ in the @Staines2023 study, compared to negligible effect reported between the March 13 and 14 UAV-lidar surveys in this study. Still, the increase in $C_p$ resulting from snow load in @Staines2023 was smaller compared to the substantial rise in $C_p$ due to trajectory angle presented in their study and as shown in @fig-lca-ht-ws. Further evidence in support of canopy snow load not being directly related to interception efficiency or $C_p$ is provided by @Lundquist2021 who reported improved simulation of subcanopy snow accumulation without the use of a maximum canopy snow load when combined with ablation process representations for canopy snow melt, sublimation, wind-induced unloading and temperature induced unloading. However, @Lehtonen2016 note that in northern Finland heavy canopy snow loads have been observed to continue increasing until stem breakage, under conditions favorable for the formation of significant rime-ice accretion and limited ablation. Models are available to predict the accretion of ice on tree canopies [e.g., @Nock2016] however, further research is required to understand the canopy snow load required to cause stem breakage across different tree species and canopy loads. 

These findings on the limited influence of air temperature and canopy snow load on initial interception challenge the theoretical basis of many existing snow interception parameterizations [@Hedstrom1998a; @Storck2002; @Satterlund1967; @Moeser2015]. To address this a new snow interception parameterization, @eq-lca-ip, is presented which calculates interception efficiency as a function of $C_p$ and $\alpha$. This new parameterization allows for canopy snow loading processes to be isolated from canopy snow ablation processes and is consistent with the rainfall interception literature [@Valante1997]. @eq-lca-ip differs only slightly from the original @Hedstrom1998a parameterization (see Equation 6 in @Hedstrom1998a), in that it does not calculate interception efficiency as a function of canopy snow load and from the @Storck2002 parameterization who proposed interception efficiency to be constant over time and space. The theoretical basis of the $\alpha$ value in @eq-lca-ip is that the association between $C_p$ and interception efficiency, as shown in @fig-lca-vs-ip, does not follow a 1:1 line as falling snow hydrometeors may bounce off the canopy elements. However, as direct measurements of $C_p$ are not widely available, an $\alpha$ value of 1 is suggested if $C_p$ is approximated from $C_c$ using @eq-lca-ac, following the fit of the nadir model in @fig-lca-vs-ip. The new snow interception routine is also similar to many recent rainfall interception studies, which calculate throughfall as a function of $C_c$ [e.g., @Valante1997].

Measurements of interception efficiency and canopy structure collected in this study corroborated with the @Hedstrom1998a theory and showed reduced throughfall on the lee side of individual trees [@fig-lidar-tf-ip]. This was attributed to predominately non-vertical hydrometeor trajectory angles which can substantially increase plot-wide $C_p$ as shown in @fig-lca-ht-ws. It was found that the mean hydrometeor trajectory angle over a snowfall event could be predicted by using the observed hydrometeor fall velocity and a mean horizontal wind speed selected at one-third of the canopy height above the ground. A wind speed at one-third the mean canopy height is thought to be important for canopy snow accumulation as a large fraction of the horizontal cross sectional area is at this height for most needleleaf canopies. While a wind speed selected at a height higher within the canopy may have a higher speed and thus more horizontal trajectory angle, less canopy elements at this height would be available for contacting incoming hydrometeors. @Katsushima2023, also proposed the wind speed at one-third the canopy height for for modelling unloading of canopy snow as it corresponds to the centre of gravity when the horizontal projection of the canopy is assumed to be a triangle. However, there is uncertainty in the transferability of one-third canopy height observed here to other environments due to differing tree structures and tree species such as those with a larger trunk space or have more of their canopy contact area at higher heights above the ground (i.e., some deciduous canopies). Moreover, @eq-ta assumes a linear hydrometeor trajectory, and does not consider non-linear patterns such as wind flow wrapping around tree elements, turbulent flow, or differences in wind speed with height. 

An existing method proposed in @Hedstrom1998a to scale canopy coverage with wind speed failed to reproduce the observations presented in @fig-lca-ht-ws. A new method is proposed which uses logistic function to calculate plot-wide $C_{inc}$ as a function of $\theta_h$ and $C_c$. Significant scatter in VoxRS measured $C_p$ across the two forest plots, illustrated by the high standard deviation in @fig-lca-ht-ws, resulted from directional (azimuth) and spatial differences in canopy structure. This large scatter suggests the observed relationships in @fig-lca-ht-ws are only applicable at the forest stand scale where the sub metre variability $C_p$ averages out. At this scale, @eq-lca-inc, which uses trajectory angle alone, could be sufficient to determine $C_{inc}$ and thus $C_p$. However, @eq-lca-inc would not applicable to areas that have large continuous gap fractions (e.g., forested clear cuts) and should be limited forested areas. Further work is required to refine the relationship proposed in @eq-lca-inc across a range of tree species and densities. A better understanding of this relationship is also important for representing the change in light transmittance through the canopy with solar zenith angle [@Niu2004a]. Also ref @Dai2019 who propose a way to represent sub-grid variability and gap distribution in the canopy, important for them for subcanopy turbulence.

Although the performance improvement in the vector-based model compared to the Nadir model is relatively small the positive bias of the VB model is preferred due to uncertainties with the throughfall measurements. Throughfall measurements by UAV-lidar over the snowfall event are inherently overestimates due to some unloading and redistribution of snow, which were estimated to be about 2 kg m^-2^. Throughfall measurements that do not include unloading and redistribution would have been slightly lower and thus better matched the vector-based model. Conversely, the Nadir model which has a stronger negative bias, would result in further overestimates. Although the Nadir model provided good performance for this event, reduced performance would be expected for a snowfall event with stronger wind speeds which would further increase $C_p$. While the vector-based model acts to increase interception efficiency with wind speed, several studies suggest that canopy snow ablation increases as a result of wind induced unloading [@Wheeler1987; @Roesch2001; @Betts1997; @Bartlett2015; @Lumbrazo2022]. While these studies have been used to develop parameterizations for wind induced unloading, they were not based on direct measurements of canopy snow unloading and further research is required to better refine these relationships to understand how wind influences canopy snow unloading after it is intercepted. Once the vector-based model is combined with a wind-induced canopy snow unloading parameterization, the overall influence of wind on canopy snow interception will be balanced to some extent.

## Conclusions

New observations of snow interception, collected over a wide range of meteorological conditions and canopy structures suggest forest structure is the primary factor governing subcanopy snow accumulation. These findings challenge the theoretical foundation of most existing snow interception parameterizations, which rely on canopy snow load and air temperature as key predictors. At the point scale, high-temporal resolution measurements revealed no evidence of a maximum canopy snow load, even for snowfalls up to 45 kg m^-2^, nor was there any indication of increased cohesion or branch bending affecting interception efficiency through air temperature. Instead, wind speed was found to either increase or decrease interception efficiency due to its influence on hydrometeor trajectory angle, which alters the apparent forest structure, or snow-leaf contact area. 

At the forest plot scale, UAV-lidar measurements of throughfall collected over a wind-driven snowfall event confirmed the results observed at the point-scale and showed leaf contact area was the main factor governing the interception efficiency at a particular site. Canopy structure metrics adjusted for trajectory angle provided an improved predictor of interception efficiency compared to nadir canopy coverage. Plot-wide canopy structure was shown to be highly sensitive to simulated hydrometeor trajectory angles. For example, using VoxRS measurements snow-leaf contact area was observed to double for simulated hydrometeor trajectories associated with a wind speeds of 1 m s^-1^ compared to vertical hydrometeor trajectories. An existing theoretical relationship failed to represent the VoxRS measured increase in leaf contact area with simulated trajectory angles.

The lack of a strong association between air temperature or canopy snow load with interception efficiency, along with the clear influence of wind speed, underscores the need for a new snow interception parameterization. A new parameterization is proposed that calculates initial interception, prior to canopy snow ablation, as a function of snowfall and leaf contact area. This parameterization is consistent with many rainfall interception studies, which also separate canopy loading and ablation processes and calculate interception as a function of canopy coverage. Additionally, a second equation is proposed to estimate the increase in leaf contact area from nadir canopy coverage as a function of hydrometeor trajectory angle. This updated snow interception parameterization showed good performance in the subalpine forest in this study, but further validation should be conducted in a range of climates, forest species, and canopy structures. Caution is advised when applying this updated routine with existing canopy snow ablation parameterizations, as these were developed in conjunction with earlier snow interception routines that also incorporated ablation processes.

## Acknowledgments

We wish to acknowledge financial support from the University of Saskatchewan Dean’s Scholarship, Natural Sciences and Engineering Research Council of Canada, Global Water Futures Programme, Alberta Innovates and the Canada Research Chairs Programme. We thank Madison Harasyn, Hannah Koslowsky, Kieran Lehan, Lindsey Langs and Fortress Mountain Resort for their help in the field. Madison Harasyn, Alistair Wallace, and Rob White contributed to developing the UAV-lidar processing workflow.

## Data Availability

The data that support the findings in this study will be made publicly available upon publication. 

\pagebreak
